# Задание 1: кроп документов

## Решение




__________________________________________________________________

## Описание
В этом разделе находятся материалы первого домашнего задания: пакет с кодом для работы с данными, вычислением метрик и пример baseline решения.

Для установки пакета выполните из `course_ocr/task1` команду `pip install -e .`

## Задача
Реализовать какой-либо алгоритм кропа с использованием нейросетей, обучить и протестировать его на публичном датасете [MIDV-500](https://github.com/fcakyon/midv500).

Можно либо скачать полноразмерную версию датасета по официальной инструкции пакета (\~70Gb), либо [скачать](https://drive.google.com/file/d/1g5MUqGhHIxriWKyZzCDQ1Qe2uT_53aKv/view?usp=sharing) сжатую версию датасета(`max(w,h)=800pix`, \~7Gb).

## Метрика
Для каждого примера датасета **из test сплита** вам необходимо предсказать четырехугольник документа (смотрите пример baseline).

Для предсказанного четырехгольника и истинного четырехугольника **вычисляется IntersectionOverUnion в пределах кадра**, и если это значение выше 95%, то кроп считается верным, иначе - ошибочным.

Для всего test сплита датасета вычисляется средняя точность предсказаний. Примерный псевдокод:
```python
AccIouAt95 = sum(
    int(iou(pred_quads[i], gt_quads[i]) > 0.95)
    for i in range(N)
) / N
```
## Требования
Вам необходимо сделать форк этого репозитория и в своем форке:
1. активировать github-actions (зайти в Actions и нажать зеленую кнопку)
1. заменить файл `task1/pred_quads.json` на файл с вашими предсказаниями в таком же формате (можно воспользоваться функцией `course_ocr_t1.metrics.dump_results_dict`)
1. добавить все необходимые для воспроизведения ваших результатов материалы ( скрипты, ноутбуки, файла )

GroundTruth четырехугольники сохранены в `task1/gt_quads.json`.

При пуше коммитов github-action будут автоматически вычислять и писать в stdout метрику на этапе "COMPUTE SCORE". Вы можете использовать функцию `course_ocr_t1.metrics.measure_crop_accuracy` для локального вычисления метрик.

## Оценка
За домашнюю работу можно получить 0-100%.
Чтобы решение было зачтено, весь код (модели, скрипты, ноутбуки) для воспроизведения ваших результатов должен быть в вашем репозитории в этом разделе.

Критерии оценки:
1. +33%: использована pretrained сеть на каком-то этапе, выполнены требования, метрика успешно посчитана
1. +33%: выполнено обучение, Accuracy выше 50%
1. +34%: Accuracy выше baseline (96%)

## Сроки
При выполнении дз в период \[01.03.2022-22.03.2022\] засчитывается полный набранный балл в соответствии с критериями.

При выполнении дз в период \[23.03.2022-10.05.2022\] если выполнены все пункты (1,2,3), то засчитывается **полный** балл; если пункт 3 не выполнен, то засчитывается **половина** от набранных баллов (т.е. максимум (0.33+0.33)/2).
